<?xml version="1.0" encoding="UTF-8"?>
<jboss-identity xmlns="urn:picketlink:idm:config:v1_0_0_ga"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                xsi:schemaLocation="urn:picketlink:idm:config:v1_0_0_ga identity-config.xsd">
    <realms>
        <realm>
            <id>realm://Otpd/OtpdLdapRealm</id>
            <repository-id-ref>OTPD Repository</repository-id-ref>
            <identity-type-mappings>
                <user-mapping>USER</user-mapping>
            </identity-type-mappings>
        </realm>
    </realms>
    <repositories>
        <repository>
            <id>OTPD Repository</id>
            <class>org.picketlink.idm.impl.repository.WrapperIdentityStoreRepository</class>
            <external-config/>
            <default-identity-store-id>OTPD LDAP Store</default-identity-store-id>
            <default-attribute-store-id>OTPD LDAP Store</default-attribute-store-id>
        </repository>
    </repositories>
    <stores>
        <attribute-stores/>
        <identity-stores>
            <identity-store>
                <id>OTPD LDAP Store</id>
                <class>org.picketlink.idm.impl.store.ldap.LDAPIdentityStoreImpl</class>
                <external-config/>
                <supported-relationship-types>
                    <relationship-type>JBOSS_IDENTITY_MEMBERSHIP</relationship-type>
                </supported-relationship-types>
                <supported-identity-object-types>
                    <identity-object-type>
                        <name>USER</name>
                        <relationships/>
                        <credentials>
                            <credential-type>PASSWORD</credential-type>
                        </credentials>
                        <attributes>
                        	<!--  User attributes -->
                        	<attribute>
                                <name>uid</name>
                                <mapping>uid</mapping>
                                <type>text</type>
                                <isRequired>true</isRequired>
                                <isMultivalued>false</isMultivalued>
                                <isReadOnly>false</isReadOnly>
                            </attribute>
                        	<attribute>
                                <name>cn</name>
                                <mapping>cn</mapping>
                                <type>text</type>
                                <isRequired>true</isRequired>
                                <isMultivalued>false</isMultivalued>
                                <isReadOnly>false</isReadOnly>
                            </attribute>
                            <attribute>
                                <name>sn</name>
                                <mapping>sn</mapping>
                                <type>text</type>
                                <isRequired>true</isRequired>
                                <isMultivalued>false</isMultivalued>
                                <isReadOnly>false</isReadOnly>
                            </attribute>
                            <attribute>
                                <name>givenName</name>
                                <mapping>givenName</mapping>
                                <type>text</type>
                                <isRequired>true</isRequired>
                                <isMultivalued>false</isMultivalued>
                                <isReadOnly>false</isReadOnly>
                            </attribute>
                            <attribute>
                                <name>mail</name>
                                <mapping>mail</mapping>
                                <type>text</type>
                                <isRequired>true</isRequired>
                                <isMultivalued>false</isMultivalued>
                                <isReadOnly>false</isReadOnly>
                            </attribute>
                            <!--  otp attributes -->
                            <attribute>
                                <name>otpkey1</name>
                                <mapping>otpkey1</mapping>
                                <type>text</type>
                                <isRequired>true</isRequired>
                                <isMultivalued>false</isMultivalued>
                                <isReadOnly>false</isReadOnly>
                            </attribute>
                            <attribute>
                                <name>otpModel</name>
                                <mapping>otpModel</mapping>
                                <type>text</type>
                                <isRequired>true</isRequired>
                                <isMultivalued>false</isMultivalued>
                                <isReadOnly>false</isReadOnly>
                            </attribute>
                            <attribute>
                                <name>otpVendor</name>
                                <mapping>otpVendor</mapping>
                                <type>text</type>
                                <isRequired>true</isRequired>
                                <isMultivalued>false</isMultivalued>
                                <isReadOnly>false</isReadOnly>
                            </attribute>
                            <attribute>
                                <name>otpSerial</name>
                                <mapping>otpSerial</mapping>
                                <type>text</type>
                                <isRequired>true</isRequired>
                                <isMultivalued>false</isMultivalued>
                                <isReadOnly>false</isReadOnly>
                            </attribute>
                            <attribute>
                                <name>otpMovingFactor</name>
                                <mapping>otpMovingFactor</mapping>
                                <type>text</type>
                                <isRequired>true</isRequired>
                                <isMultivalued>false</isMultivalued>
                                <isReadOnly>false</isReadOnly>
                            </attribute>
                            <attribute>
                                <name>otpPIN</name>
                                <mapping>otpPIN</mapping>
                                <type>text</type>
                                <isRequired>true</isRequired>
                                <isMultivalued>false</isMultivalued>
                                <isReadOnly>false</isReadOnly>
                            </attribute>
                             <attribute>
                                <name>otpKeyEncryption</name>
                                <mapping>otpKeyEncryption</mapping>
                                <type>text</type>
                                <isRequired>true</isRequired>
                                <isMultivalued>false</isMultivalued>
                                <isReadOnly>false</isReadOnly>
                            </attribute>
                        </attributes>
                        <options>
                            <option>
                                <name>idAttributeName</name>
                                <value>${idAttributeName}</value>
                            </option>
                            <option>
                                <name>passwordAttributeName</name>
                                <value>password</value>
                            </option>
                            <option>
                                <name>ctxDNs</name>
                                <value>${userCtxDNs}</value>
                            </option>
                            <option>
                                <name>allowCreateEntry</name>
                                <value>true</value>
                            </option>
                            <option>
								<name>entrySearchScope</name>
								<value>subtree</value>
							</option>
						    <option>
                                <name>createEntryAttributeValues</name>
                                <value>objectClass=top</value>
                                <value>objectClass=inetOrgPerson</value>
                                <value>objectClass=OtpToken</value>
                                <value>sn= </value>
                                <value>cn= </value>
                                <value>uid= </value>
                                <value>mail= </value>
                                <value>givenName= </value>
                                <value>otpkey1= </value>
                                <value>otpModel= </value>
                                <value>otpVendor= </value>
                                <value>otpSerial= </value>
                            </option>
                        </options>
                    </identity-object-type>
                    <identity-object-type>
                        <name>GROUP</name>
                        <relationships>
                            <relationship>
                                <relationship-type-ref>JBOSS_IDENTITY_MEMBERSHIP</relationship-type-ref>
                                <identity-object-type-ref>USER</identity-object-type-ref>
                            </relationship>
                            <relationship>
                                <relationship-type-ref>JBOSS_IDENTITY_MEMBERSHIP</relationship-type-ref>
                                <identity-object-type-ref>GROUP</identity-object-type-ref>
                            </relationship>
                        </relationships>
                        <credentials/>
                        <attributes/>
                        <options>
                            <option>
                                <name>idAttributeName</name>
                                <value>${idAttributeName}</value>
                            </option>
                            <option>
                                <name>ctxDNs</name>
                                <value>${gruopCtxDns}</value>
                            </option>
                            <option>
                                <name>allowCreateEntry</name>
                                <value>true</value>
                            </option>
                            <option>
                                <name>membershipAttributeName</name>
                                <value>member</value>
                            </option>
                            <option>
                                <name>isMembershipAttributeDN</name>
                                <value>true</value>
                            </option>
                            <option>
                                <name>allowEmptyMemberships</name>
                                <value>true</value>
                            </option>
                            <option>
                                <name>createEntryAttributeValues</name>
                                <value>objectClass=top</value>
                                <value>objectClass=groupOfNames</value>
                            </option>
                        </options>
                    </identity-object-type>
                </supported-identity-object-types>
                <options>
                    <option>
                        <name>providerURL</name>
                        <value>${providerURL}</value>
                    </option>
                    <option>
                        <name>adminDN</name>
                        <value>${adminDN}</value>
                    </option>
                    <option>
                        <name>adminPassword</name>
                        <value>${adminPassword}</value>
                    </option>
                    <option>
                        <name>searchTimeLimit</name>
                        <value>10000</value>
                    </option>
                </options>
            </identity-store>
        </identity-stores>
    </stores>
</jboss-identity>